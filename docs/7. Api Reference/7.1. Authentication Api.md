# Authentication API



## Table of Contents
1. [Introduction](#introduction)
2. [Authentication Endpoints](#authentication-endpoints)
3. [Request and Response Schemas](#request-and-response-schemas)
4. [Authentication Flow](#authentication-flow)
5. [Session Management](#session-management)
6. [Error Handling](#error-handling)
7. [Middleware Integration](#middleware-integration)
8. [Security Considerations](#security-considerations)

## Introduction
The Authentication API in exim-pilot provides secure user authentication and session management for the system. It implements a session-based authentication mechanism using cryptographically secure session IDs stored server-side. The API handles user login, session validation, and logout operations while maintaining audit logs for all authentication activities. This documentation details the RESTful endpoints, request/response formats, error conditions, and integration with middleware for protected routes.

**Section sources**
- [auth_handlers.go](file://internal/api/auth_handlers.go#L1-L50)
- [service.go](file://internal/auth/service.go#L1-L30)

## Authentication Endpoints

### Login Endpoint
**URL**: `/api/v1/auth/login`  
**Method**: `POST`  
**Description**: Authenticates a user with username and password credentials and creates a new session.

#### Request Example (curl)

```bash
curl -X POST https://exim-pilot.example.com/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "securepassword"
  }'
```


#### Successful Response (200 OK)
```json
{
  "user": {
    "id": 1,
    "username": "admin",
    "email": "admin@example.com",
    "full_name": "Administrator",
    "is_active": true,
    "last_login_at": "2023-12-07T10:30:00Z",
    "created_at": "2023-01-15T08:00:00Z",
    "updated_at": "2023-12-07T10:30:00Z"
  },
  "session_id": "a1b2c3d4e5f67890a1b2c3d4e5f67890a1b2c3d4e5f67890a1b2c3d4e5f67890",

**Referenced Files in This Document**   
- [auth_handlers.go](file://internal/api/auth_handlers.go)
- [service.go](file://internal/auth/service.go)
- [models.go](file://internal/database/models.go)
- [repository.go](file://internal/database/repository.go)
- [middleware.go](file://internal/api/middleware.go)